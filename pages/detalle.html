<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalle | CAC-MOVIES</title>
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css">
    <link rel="stylesheet" href="../css/estilos.css">
    <script src="https://kit.fontawesome.com/f7fb471b65.js" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,300&display=swap" rel="stylesheet">
    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
</head>
<body>
    <header class="header">
        <nav class="navegacion">
            <a class="anclaLogo" href="../index.html">
                <i class="fas fa-film" aria-hidden="true"></i>
                <span>CAC-Movies</span>
            </a>
            <ul class="listaNav">
                <li class="listaItem"><a class="linkNav" href="../index.html#tendencias">Tendencias</a></li>
                <li class="listaItem"><a class="linkNav" href="./registrarse.html">Registrarse</a></li>
                <li class="listaItem"><a class="linkNav iniciarSesion" href="./iniciosesion.html">Iniciar Sesión</a></li>
            </ul>
        </nav>
    </header>
    <main id="mainDetalle" class="mainDetalle">
      <section class="detalle"  data-aos="zoom-in" >
        <div class="contenedorDetalle" >
            <div class="" id="imagenPelicula">
                <img src="" alt="">
            </div>
            <div class="textoDetalle" id="textoDetalle">
                <h1 id="titulo">No se encontro la Pelicula</h1>
                <p id="fechaLanzamiento"></p>
                <h2>Sinopsis</h2>
                <p id="sinopsis"></p>
                <div class="contenedorCreditos">
                    <div>
                        <h3 id="director"></h3>
                        <p></p>
                    </div>
                    <div>
                        <h3 id="reparto"></h3>
                        <p></p>
                    </div>
                    
                </div>
               
            </div>
        </div>
       

      </section>

     

    </main>
    <footer class="footer">
        <nav class="navegacion">
            <ul class="listaNav">
                <li class="listaItem"><a class="linkNav" href="">Términos y condiciones</a></li>
                <li class="listaItem"><a class="linkNav" href="">Preguntas frecuentes</a></li>
                <li class="listaItem"><a class="linkNav" href="">Ayuda</a></li>
                <li class="listaItem"><a id="administrador" class="linkNav administradorPeliculas" href="">Administrador Peliculas</a></li>
            </ul>
        </nav>
        <a href="#main" class="flechaArriba">
            <img src="../assets/img/flecha-hacia-arriba.png" alt="ir arriba flecha">
        </a>
    </footer>
    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
    <script>
    AOS.init();
    </script>
    <script>
        // si en el localstore tiene guardado es_admin = 'S' entonces se muestra el link de administrador
        if (localStorage.getItem('es_admin') === 'S') {
            document.getElementById('administrador').style.display = 'block';
        }else{
            document.getElementById('administrador').style.display = 'none';
        }
        // si esta pagina se cargo con un parametro buscar, entonces le tengo que pegar al api de peliculas para traer los datos de esta pelicula
        const urlParams = new URLSearchParams(window.location.search);
        console.log(urlParams);
        const buscar = urlParams.get('buscar');
        console.log(buscar);
        if (buscar) {
            fetch(`http://localhost/moviesphp/peliculas?buscar=${buscar}`)
            .then(response => response.json())
            .then(data => {
                console.log(data);
                // si la pelicula no existe, entonces redirijo al index
                if (data=== 0) {
                    setTimeout(() => {
                        window.location.href = '../index.html';
                    }, 3000);
                  
                }
                // si la pelicula existe, entonces muestro los datos
                document.getElementById('imagenPelicula').innerHTML = `<img src="../assets/img/${data[0].imagen}" alt="${data[0].titulo}" width="300px">`;
                document.getElementById('titulo').innerText = data[0].titulo;
                document.getElementById('fechaLanzamiento').innerText = `${data[0].fecha_lanzamiento} • ${data[0].genero} • ${data[0].duracion}`;
                
                document.getElementById('director').innerText = `${data[0].director}`;
                document.getElementById('reparto').innerText = `${data[0].reparto}`;
                document.getElementById('sinopsis').innerText = `${data[0].sinopsis}`;

            });
        }
    </script>
</body>
</html>